---
title: X86汇编语言学习(一)基础知识与MBR分区
tags:
  - 汇编
  - 寄存器
categories: 编程语言
abbrlink: d37596c7
date: 2021-08-06 14:25:33
---

## 基础知识

1 字(Word)=2 字节(Byte)=16 比特(bit)

## 通用寄存器

### 8086 16 位寄存器

可分成 8 位独立寄存器

- AX - AH,AL
- BX - BH,BL
- CX - CH,CL
- DX - DH,DL

- SI
- DI
- BP
- SP

### 现代电脑寄存器

![xxx](https://cdn.jsdelivr.net/gh/FLDPMpang/img_host@main/20210523/xxx.6lak0px57oo0.png)

## 内存

8086 可以访问 1M 的内存空间。其中 `0x00000-0x9FFFF` 属于常规内存，由内存条提供
0xF0000-0xFFFFF 由主板上的 ROM-BIOS 提供。

中间还剩余的 320KB 的空洞，即 `0xA0000-0xEFFFF`，这段空间就由外设来提供，其中就包括显卡的显存部分

## 地址

对于显存等需要使用逻辑地址访问

**逻辑地址 段地址:偏移地址**

在编译阶段,每条指令被赋予了一个汇编地址,加载到物理内存后,它在段内的偏移地址和编译时汇编地址相同

## 指令

### 标号 与 Jmp 指令

```
flag : jump near flag
```

标号代表该指令的汇编地址

Jmp 指令可使用绝对地址和标号
执行时,指令指针寄存器 IP 加上操作数再加操作长度,得到了实际偏移地址

### Mov 指令

![xxx](https://cdn.jsdelivr.net/gh/FLDPMpang/img_host@main/20210523/xxx.374yfycxxrq0.png)

### Div 指令

```
div 除数
```

| 种类          | 被除数地址              | 商  | 余数 |
| ------------- | ----------------------- | --- | ---- |
| 16 位除 8 位  | AX                      | AL  | AH   |
| 32 位除 16 位 | 高 16 在 DX,低 16 在 AX | AX  | DX   |

### 声明数据

- db 声明字节
- dd 声明字
- dd 声明双字
- dq 声明四字

### Xor 指令

```
xor 被异或数,异或数
```

被异或数和异或数要是相同宽度的通用寄存器或内存单元

## 主扇区

主引导扇区的大小为 512 字节、ROM-BIOS 将它加载到处理器的地址空间的逻辑地址`0x0000:0x7c00`处
也就是物理地址 `0x07c00`处，然后判断最后两个字节:0x55,0xAA,说明主扇区有效

可在最后定义

```
dw 0xaa55
```

## 文字显示

**文本模式** 显存物理起始地址 : `0xB8000`

每个显示字符对应两个字节

- 字符 ASCII 码
- 控制字符
  控制字符格式: |K|R|G|B|I|R|G|B| (高位背景色,低位前景色)

![2021-08-10 12-30-32 的屏幕截图](https://cdn.jsdelivr.net/gh/FLDPMpang/img_host@main/20210523/2021-08-10 12-30-32 的屏幕截图.7gtmb0nbzt0.png)
